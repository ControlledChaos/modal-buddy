!function(e){var t,i,n;window.bp_tb_position=function(){var n=e(window).width(),o=e(window).height(),a=!1;"undefined"!=typeof TB_WIDTH&&"undefined"!=typeof TB_HEIGHT&&"undefined"!=typeof tb_position&&("undefined"==typeof t&&(t=TB_WIDTH),"undefined"==typeof i&&(i=TB_HEIGHT),TB_WIDTH>n?(window.TB_WIDTH=n-50,a=!0):n>t&&(window.TB_WIDTH=t,a=!0),TB_HEIGHT>o?(window.TB_HEIGHT=o-50,a=!0):o>i&&(window.TB_HEIGHT=i,a=!0),!0===a&&(window.tb_position(),e("#TB_window").css({height:TB_HEIGHT+"px"}),e("#TB_iframeContent").css({width:t-1+"px",height:TB_HEIGHT-1+"px"})))},e("a.modal-buddy").each(function(){var t=e(this).attr("href"),i=e(window).width(),n=e(window).height();if(t){var o=t.match(/width=([0-9]+)/),a=t.match(/height=([0-9]+)/);o[1]&&(t=parseInt(o[1],10)>i?t.replace(/width=[0-9]+/g,"width="+Number(i-50)):t.replace(/width=[0-9]+/g,"width="+o[1])),a[1]&&(t=parseInt(a[1],10)>n?t.replace(/height=[0-9]+/g,"height="+Number(n-50)):t.replace(/height=[0-9]+/g,"height="+a[1])),e(this).attr("href",t)}}),e(document).ready(function(){window.tb_init("a.modal-buddy"),e("body").addClass("modal-buddy")}),window.tb_showIframe=function(){var t,i=e("#TB_iframeContent").prop("src").match(/modal-buddy/);null!==i&&("undefined"!=typeof e("#TB_iframeContent").get(0).contentWindow.bp&&(t=e("#TB_iframeContent").get(0).contentWindow.bp),t&&"undefined"!=typeof t.Avatar&&t.Avatar.Attachment.on("change:url",updateAvatars),t&&"undefined"!=typeof t.CoverImage&&t.CoverImage.Attachment.on("change:url",updateCoverImage),e("#TB_title").append('<div id="bp-modal-buttons"><a href="#" id="bp-modal-full-height"><span class="screen-reader-text">Zoom</span><div class="bp-full-height-icon"></div></a>'))},e("body").on("click","#bp-modal-buttons .bp-full-height-icon",function(i){i.preventDefault();var o=e(this);window.bp_tb_position(),"undefined"==typeof n&&(n=e("#TB_iframeContent").prop("style").height),o.hasClass("max")?(window.TB_HEIGHT=n,o.removeClass("max")):(window.TB_HEIGHT=e(window).height()-50,o.addClass("max")),window.tb_position(),e("#TB_window").css({height:TB_HEIGHT+"px"}),e("#TB_iframeContent").css({width:t-1+"px",height:TB_HEIGHT-1+"px"})}),e(window).resize(function(){window.bp_tb_position()}),updateAvatars=function(t){"undefined"!=typeof t.attributes&&e("."+t.attributes.object+"-"+t.attributes.item_id+"-avatar").each(function(){e(this).prop("src",t.attributes.url)})},updateCoverImage=function(t){if("undefined"!=typeof t.attributes){var i="none";t.attributes.url&&(i="url( "+t.attributes.url+" )"),e("#header-cover-image").css({"background-image":i}),e(".bp-cover-image-preview").length&&(t.attributes.url?(e(".bp-cover-image-preview").addClass("thickbox"),e(".bp-cover-image-preview").removeClass("hide")):(e(".bp-cover-image-preview").addClass("hide"),e(".bp-cover-image-preview").removeClass("thickbox")),e(".bp-cover-image-preview").prop("href",t.attributes.url))}}}(jQuery);